[{"title":"dpdkå ç”¨æ’æŸ¥","url":"/2026/02/26/dpdk%E5%8D%A0%E7%94%A8%E6%8E%92%E6%9F%A5/","content":"å½“ç½‘å¡â€œæ¶ˆå¤±â€ä¸”æ€€ç–‘è¢« DPDK ç¨‹åºå ç”¨æ—¶ï¼ˆå¦‚ eth0 åœ¨ ip link ä¸­ä¸å¯è§ï¼Œä½† lspci ä»èƒ½è¯†åˆ«ç¡¬ä»¶ï¼‰ï¼Œæ ¸å¿ƒåŸå› æ˜¯ï¼šDPDK é€šè¿‡ UIO&#x2F;VFIO é©±åŠ¨å°†ç½‘å¡ä»å†…æ ¸è§£ç»‘ï¼Œç§»äº¤è‡³ç”¨æˆ·æ€ç¨‹åºæ§åˆ¶ã€‚ä»¥ä¸‹æ˜¯ç²¾å‡†æ’æŸ¥ä¸å®šä½æ–¹æ³•ï¼š\n\nğŸ” ä¸‰æ­¥å®šä½ï¼šæ˜¯å¦è¢« DPDK å ç”¨ + è°åœ¨å ç”¨âœ… ç¬¬ä¸€æ­¥ï¼šç¡®è®¤ç½‘å¡æ˜¯å¦è¢«ç»‘å®šåˆ° DPDK é©±åŠ¨# 1. æ‰¾åˆ°ç½‘å¡ PCI åœ°å€ï¼ˆç¤ºä¾‹ï¼‰lspci -nn | grep -i ethernet# è¾“å‡ºç¤ºä¾‹ï¼š01:00.0 Ethernet controller [0200]: Intel Corporation ...# 2. æ£€æŸ¥å½“å‰ç»‘å®šçš„é©±åŠ¨lspci -k -s 0000:01:00.0  # æ›¿æ¢ä¸ºå®é™… PCI åœ°å€\n\nå…³é”®åˆ¤æ–­ï¼šKernel driver in use: igb_uio &#x2F; vfio-pci &#x2F; uio_pci_generic â†’ å·²è¢« DPDK å ç”¨Kernel driver in use: ixgbe &#x2F; e1000e ç­‰ â†’ æœªè¢« DPDK å ç”¨ï¼ˆæ’æŸ¥å…¶ä»–åŸå› ï¼‰\n\nâœ… ç¬¬äºŒæ­¥ï¼šå®šä½å ç”¨è¿›ç¨‹ï¼ˆæ ¸å¿ƒï¼ï¼‰# æ–¹æ³•1ï¼šæ£€æŸ¥æ‰“å¼€çš„ UIO/VFIO è®¾å¤‡ï¼ˆæœ€ç›´æ¥ï¼‰sudo lsof /dev/uio* /dev/vfio/* 2&gt;/dev/null | grep -v &quot;COMMAND&quot;# æˆ–sudo fuser -v /dev/uio* /dev/vfio/* 2&gt;/dev/null# æ–¹æ³•2ï¼šæ‰«ææ‰€æœ‰è¿›ç¨‹çš„ fdï¼ˆéœ€ rootï¼‰sudo find /proc/[0-9]*/fd -lname &quot;*uio*&quot; -o -lname &quot;*vfio*&quot; 2&gt;/dev/null | \\  while read fd; do     pid=$(echo $fd | cut -d/ -f3)    echo &quot;PID: $pid | $(ps -p $pid -o comm= 2&gt;/dev/null || echo &#x27;terminated&#x27;)&quot;  done# æ–¹æ³•3ï¼šæ£€æŸ¥ DPDK è¿›ç¨‹ç‰¹å¾ps aux | grep -E &quot;testpmd|l2fwd|l3fwd|dpdk|ovs|vpp|fd.io&quot; | grep -v greppgrep -a -f &quot;dpdk|testpmd&quot; 2&gt;/dev/null\n\nè¾“å‡ºç¤ºä¾‹ï¼štestpmd 12345 root 5u CHR 241,0 ... /dev/uio0 â†’ PID 12345 çš„ testpmd å ç”¨\n\nâœ… ç¬¬ä¸‰æ­¥ï¼šè¾…åŠ©éªŒè¯ï¼ˆå¢å¼ºå¯ä¿¡åº¦ï¼‰# æ£€æŸ¥ DPDK ç»‘å®šå·¥å…·çŠ¶æ€ï¼ˆè‹¥å·²å®‰è£…ï¼‰dpdk-devbind.py --status 2&gt;/dev/null | grep -A 5 &quot;0000:01:00.0&quot;# æ£€æŸ¥å†…æ ¸æ—¥å¿—ï¼ˆç»‘å®šæ—¶é—´ç‚¹ï¼‰dmesg | grep -i &quot;uio\\|vfio\\|bound to driver&quot; | tail -20# æ£€æŸ¥ UIO è®¾å¤‡å…³è”ls -l /sys/class/uio/ 2&gt;/dev/null &amp;&amp; cat /sys/class/uio/uio*/name\n\n\nğŸ“Œ å…³é”®ç‰¹å¾æ€»ç»“ï¼ˆå¿«é€Ÿåˆ¤æ–­ï¼‰\n\n\nç°è±¡\nè¯´æ˜\n\n\n\nlspci èƒ½çœ‹åˆ°ç½‘å¡ï¼Œä½† ip link æ— å¯¹åº”æ¥å£\né«˜åº¦ç–‘ä¼¼ DPDK å ç”¨\n\n\nlspci -k æ˜¾ç¤ºé©±åŠ¨ä¸º igb_uio&#x2F;vfio-pci\nç¡®è®¤è¢« DPDK é©±åŠ¨æ¥ç®¡\n\n\n/dev/uio* æˆ– /dev/vfio/* è¢«è¿›ç¨‹æ‰“å¼€\nç›´æ¥å®šä½å ç”¨ç¨‹åº\n\n\ndpdk-devbind.py --status æ ‡æ³¨ â€œdrv&#x3D;igb_uioâ€\nDPDK ç»‘å®šçŠ¶æ€æ˜ç¡®\n\n\n\nâš ï¸ æ³¨æ„äº‹é¡¹\næƒé™è¦æ±‚ï¼šlsof&#x2F;fuser&#x2F;/proc æ‰«æéœ€ root æƒé™ï¼Œå¦åˆ™å¯èƒ½æ¼æ£€ã€‚\nè¿›ç¨‹å·²é€€å‡ºä½†é©±åŠ¨æœªè§£ç»‘ï¼š  \nè‹¥ lsof æ— è¾“å‡ºä½†é©±åŠ¨ä»ä¸º igb_uioï¼Œè¯´æ˜è¿›ç¨‹å·²é€€å‡ºä½†æœªé‡Šæ”¾è®¾å¤‡ã€‚  \næ¢å¤æ–¹æ³•ï¼š  echo &quot;0000:01:00.0&quot; | sudo tee /sys/bus/pci/drivers/igb_uio/unbindecho &quot;0000:01:00.0&quot; | sudo tee /sys/bus/pci/drivers/ixgbe/bind  # æ›¿æ¢ä¸ºåŸé©±åŠ¨å\n\n\näº‘ç¯å¢ƒ&#x2F;å®¹å™¨ï¼š  \nå®¹å™¨å†…è¿è¡Œçš„ DPDK ç¨‹åºéœ€åœ¨å®¿ä¸»æœºæ’æŸ¥ï¼ˆæ£€æŸ¥å®¿ä¸»æœº /dev å’Œè¿›ç¨‹ï¼‰ã€‚\näº‘å¹³å°ï¼ˆå¦‚é˜¿é‡Œäº‘ï¼‰éœ€ç¡®è®¤æ˜¯å¦å¯ç”¨ SR-IOV + VF è¢« DPDK å ç”¨ã€‚\n\n\nå®‰å…¨æ“ä½œï¼š  \nåˆ‡å‹¿ç›´æ¥ kill è¿›ç¨‹ï¼å…ˆç¡®è®¤ä¸šåŠ¡å½±å“ï¼ˆå¦‚ OVS-DPDKã€VPPã€è‡ªç ”è½¬å‘ç¨‹åºï¼‰ã€‚  \næ¢å¤ç½‘å¡å‰ï¼Œç¡®ä¿ DPDK ç¨‹åºå·²å®‰å…¨åœæ­¢ã€‚\n\n\n\n\nğŸ’¡ ä¸€å¥è¯æ€»ç»“\nâ€œç½‘å¡ç¡¬ä»¶å­˜åœ¨ä½†å†…æ ¸çœ‹ä¸è§â€ + â€œé©±åŠ¨æ˜¾ç¤º igb_uio&#x2F;vfio-pciâ€ &#x3D; DPDK å ç”¨ï¼›ç”¨ lsof /dev/uio* æˆ–æ‰«æ /proc/*/fd ç²¾å‡†å®šä½å ç”¨è¿›ç¨‹ã€‚\n\né€šè¿‡ä»¥ä¸Šæ–¹æ³•ï¼Œå¯å¿«é€ŸåŒºåˆ†â€œå‘½åè§„åˆ™å˜æ›´â€ä¸â€œDPDK å ç”¨â€ï¼Œé¿å…è¯¯åˆ¤ã€‚å¦‚éœ€è¿›ä¸€æ­¥åˆ†æï¼Œæä¾› lspci -k -s &lt;PCI&gt; å’Œ lsof /dev/uio* è¾“å‡ºå³å¯ç²¾å‡†å®šä½ã€‚\n","categories":["é—®é¢˜æ’æŸ¥"]},{"title":"Hexo + GitHub Pages æ­å»ºä¸ªäººåšå®¢å…¨æµç¨‹æŒ‡å—","url":"/2026/02/26/hexo_github%E9%83%A8%E7%BD%B2%E4%B8%AA%E4%BA%BA%E5%8D%9A%E5%AE%A2/","content":"ğŸŒ Hexo + GitHub Pages æ­å»ºä¸ªäººåšå®¢å…¨æµç¨‹æŒ‡å—ï¼ˆ2024 æœ€æ–°ç‰ˆï¼‰\nğŸ’¡ æœ¬æŒ‡å—é€‚ç”¨äº Windows&#x2F;macOS&#x2F;Linuxï¼Œå…¨ç¨‹çº¦ 30 åˆ†é’Ÿï¼Œé™„å…³é”®é¿å‘æç¤º\n\n\nğŸ”‘ ä¸€ã€å‰ç½®å‡†å¤‡\n\n\né¡¹ç›®\nè¦æ±‚\néªŒè¯å‘½ä»¤\n\n\n\nGitHub è´¦å·\næ³¨å†Œåœ°å€\n-\n\n\nNode.js (LTS)\nâ‰¥ 18.x\nnode -v npm -v\n\n\nGit\nâ‰¥ 2.30\ngit --version\n\n\nç¼–è¾‘å™¨\nVS Code &#x2F; Typora ç­‰\n-\n\n\nâœ… åŠ é€Ÿå»ºè®®ï¼ˆå›½å†…ç”¨æˆ·ï¼‰ï¼š\n# è®¾ç½® npm æ·˜å®é•œåƒnpm config set registry https://registry.npmmirror.com# å¯é€‰ï¼šå®‰è£… cnpmnpm install -g cnpm --registry=https://registry.npmmirror.com\n\n\nğŸ“¦ äºŒã€å®‰è£…ä¸åˆå§‹åŒ– Hexo# 1. å…¨å±€å®‰è£… Hexo CLInpm install -g hexo-cli# 2. åˆ›å»ºåšå®¢ç›®å½•ï¼ˆmy-blog å¯è‡ªå®šä¹‰ï¼‰hexo init my-blogcd my-blog# 3. å®‰è£…ä¾èµ–ï¼ˆå›½å†…å»ºè®®ç”¨ cnpmï¼‰npm install  # æˆ– cnpm install# 4. æœ¬åœ°é¢„è§ˆï¼ˆæµè§ˆå™¨è®¿é—® http://localhost:4000ï¼‰hexo clean &amp;&amp; hexo g &amp;&amp; hexo s\nâœ… å‡ºç° Hexo é»˜è®¤æ¬¢è¿é¡µå³æˆåŠŸï¼\n\nğŸ¨ ä¸‰ã€ä¸ªæ€§åŒ–é…ç½®ï¼ˆå…³é”®æ­¥éª¤ï¼‰1ï¸âƒ£ åŸºç¡€é…ç½®ï¼ˆ_config.ymlï¼‰# ç«™ç‚¹ä¿¡æ¯title: æˆ‘çš„åšå®¢subtitle: è®°å½•æˆé•¿author: ä½ çš„åå­—language: zh-CNtimezone: Asia/Shanghai# URLï¼ˆéƒ¨ç½²åä¿®æ”¹ä¸ºä½ çš„åŸŸåï¼‰url: https://yourname.github.ioroot: /# ç”Ÿæˆè®¾ç½®permalink: :year/:month/:day/:title/permalink_defaults:\n\n2ï¸âƒ£ å®‰è£…ä¸»é¢˜ï¼ˆä»¥ Butterfly ä¸ºä¾‹ï¼‰# è¿›å…¥ themes ç›®å½•cd themesgit clone -b master https://github.com/jerryc127/hexo-theme-butterfly.git butterflycd ../# ä¿®æ”¹ _config.ymltheme: butterfly\nğŸ“Œ ä¸»é¢˜é…ç½®ï¼šå¤åˆ¶ themes/butterfly/_config.yml.example ä¸º _config.butterfly.ymlï¼ŒæŒ‰éœ€ä¿®æ”¹ï¼ˆèœå•ã€è¯„è®ºã€SEOç­‰ï¼‰\n3ï¸âƒ£ å¸¸ç”¨æ’ä»¶ï¼ˆæŒ‰éœ€å®‰è£…ï¼‰npm install hexo-generator-searchdb --save    # ç«™å†…æœç´¢npm install hexo-wordcount --save            # å­—æ•°ç»Ÿè®¡npm install hexo-abbrlink --save             # æ°¸ä¹…é“¾æ¥ï¼ˆé¿å…ä¸­æ–‡è·¯å¾„é—®é¢˜ï¼‰\n\n\nğŸ“ å››ã€æ’°å†™ä¸é¢„è§ˆ# åˆ›å»ºæ–°æ–‡ç« ï¼ˆè‡ªåŠ¨åœ¨ source/_posts/ ç”Ÿæˆ .md æ–‡ä»¶ï¼‰hexo new &quot;æˆ‘çš„ç¬¬ä¸€ç¯‡åšå®¢&quot;# æœ¬åœ°å®æ—¶é¢„è§ˆï¼ˆä¿®æ”¹åè‡ªåŠ¨åˆ·æ–°ï¼‰hexo clean &amp;&amp; hexo g &amp;&amp; hexo s --debug\nâœ¨ å†™ä½œæŠ€å·§ï¼š\n\nä½¿ç”¨ Markdown ç¼–è¾‘ï¼ˆæ¨è Typora&#x2F;VS Code + Markdown æ’ä»¶ï¼‰\nå›¾ç‰‡å»ºè®®å­˜å…¥ source/images/ï¼Œå¼•ç”¨ç›¸å¯¹è·¯å¾„\næ–‡ç«  Front-matter æ·»åŠ åˆ†ç±»&#x2F;æ ‡ç­¾ï¼š---title: ç¤ºä¾‹date: 2024-02-26tags: [Hexo, æ•™ç¨‹]categories: æŠ€æœ¯---\n\n\nğŸš€ äº”ã€éƒ¨ç½²åˆ° GitHub Pagesï¼ˆæ ¸å¿ƒæ­¥éª¤ï¼‰1ï¸âƒ£ åˆ›å»ºä»“åº“\nä»“åº“åå¿…é¡»ä¸ºï¼šä½ çš„GitHubç”¨æˆ·å.github.ioï¼ˆå¦‚ zhangsan.github.ioï¼‰\né€‰æ‹© Publicï¼ˆå…è´¹ç”¨æˆ·ç§æœ‰ä»“åº“æ— æ³•å¯ç”¨ Pagesï¼‰\n\n2ï¸âƒ£ é…ç½® SSH å¯†é’¥ï¼ˆå…å¯†éƒ¨ç½²ï¼‰# ç”Ÿæˆå¯†é’¥ï¼ˆä¸€è·¯å›è½¦ï¼‰ssh-keygen -t ed25519 -C &quot;your_email@example.com&quot;# å¤åˆ¶å…¬é’¥å†…å®¹cat ~/.ssh/id_ed25519.pub  # Windows: type %USERPROFILE%\\.ssh\\id_ed25519.pub# GitHub æ“ä½œï¼š# Settings â†’ SSH and GPG keys â†’ New SSH key â†’ ç²˜è´´å…¬é’¥\nâœ… æµ‹è¯•è¿æ¥ï¼šssh -T git@github.comï¼ˆçœ‹åˆ° â€œHi xxx! Youâ€™ve successfully authenticatedâ€ å³æˆåŠŸï¼‰\n3ï¸âƒ£ é…ç½®éƒ¨ç½²ï¼ˆ_config.yml æœ«å°¾ï¼‰deploy:  type: git  repo: git@github.com:ä½ çš„ç”¨æˆ·å/ä½ çš„ç”¨æˆ·å.github.io.git  branch: main  # âš ï¸ é‡è¦ï¼šç¡®è®¤ä»“åº“é»˜è®¤åˆ†æ”¯åï¼ˆæ–°ç‰ˆ GitHub ä¸º mainï¼‰\n\n4ï¸âƒ£ å®‰è£…éƒ¨ç½²æ’ä»¶ &amp; éƒ¨ç½²npm install hexo-deployer-git --savehexo clean &amp;&amp; hexo g &amp;&amp; hexo deploy\nğŸŒ è®¿é—®ï¼šhttps://ä½ çš„ç”¨æˆ·å.github.ioï¼ˆé¦–æ¬¡éƒ¨ç½²éœ€ç­‰å¾… 2-5 åˆ†é’Ÿï¼‰\n\nğŸŒ å…­ã€ç»‘å®šè‡ªå®šä¹‰åŸŸåï¼ˆå¯é€‰ä½†æ¨èï¼‰\nè´­ä¹°åŸŸåï¼ˆé˜¿é‡Œäº‘&#x2F;è…¾è®¯äº‘ç­‰ï¼‰\næ·»åŠ  CNAME æ–‡ä»¶ï¼š\nåœ¨ source/ ç›®å½•æ–°å»º CNAME æ–‡ä»¶ï¼ˆæ— åç¼€ï¼‰ï¼Œå†…å®¹ä¸ºï¼šwww.yourdomain.com\n\n\nDNS è§£æè®¾ç½®ï¼š\nA è®°å½• â†’ æŒ‡å‘ GitHub Pages IPï¼ˆä»»é€‰å…¶ä¸€ï¼‰ï¼š185.199.108.153185.199.109.153185.199.110.153185.199.111.153\næˆ– CNAME è®°å½• â†’ æŒ‡å‘ ä½ çš„ç”¨æˆ·å.github.io\n\n\nGitHub ä»“åº“è®¾ç½®ï¼š\nSettings â†’ Pages â†’ Custom domain å¡«å†™åŸŸå â†’ å‹¾é€‰ âœ… Enforce HTTPS\n\n\n\n\nğŸ› ï¸ ä¸ƒã€é«˜é¢‘é—®é¢˜è§£å†³æ–¹æ¡ˆ\n\n\né—®é¢˜\nè§£å†³æ–¹æ¡ˆ\n\n\n\néƒ¨ç½²å¤±è´¥&#x2F;æƒé™é”™è¯¯\næ£€æŸ¥ SSH å¯†é’¥æ˜¯å¦æ·»åŠ ï¼›ssh -T git@github.com æµ‹è¯•\n\n\né¡µé¢ç©ºç™½&#x2F;æ ·å¼ä¸¢å¤±\næ£€æŸ¥ _config.yml ä¸­ url æ˜¯å¦ä¸ºéƒ¨ç½²ååœ°å€ï¼›æ¸…é™¤æµè§ˆå™¨ç¼“å­˜\n\n\nä¸­æ–‡è·¯å¾„ 404\nå®‰è£… hexo-abbrlink æ’ä»¶ï¼Œé…ç½®æ°¸ä¹…é“¾æ¥\n\n\nå›¾ç‰‡ä¸æ˜¾ç¤º\nä½¿ç”¨ç›¸å¯¹è·¯å¾„ï¼›æˆ–è®¾ç½® _config.yml ä¸­ post_asset_folder: true\n\n\néƒ¨ç½²åå†…å®¹æœªæ›´æ–°\nhexo clean æ¸…é™¤ç¼“å­˜åé‡æ–°éƒ¨ç½²\n\n\nGitHub Pages æœªç”Ÿæ•ˆ\næ£€æŸ¥ä»“åº“ Settings â†’ Pages â†’ Branch æ˜¯å¦ä¸º main&#x2F;gh-pages\n\n\n\nğŸ”’ å…«ã€ç»´æŠ¤ä¸è¿›é˜¶å»ºè®®\nå¤‡ä»½æºç ï¼šå°†æ•´ä¸ª my-blog ç›®å½•ï¼ˆå« source/, themes/, _config.ymlï¼‰å­˜è‡³ç§æœ‰ä»“åº“æˆ–ç½‘ç›˜\nè‡ªåŠ¨åŒ–éƒ¨ç½²ï¼šé…ç½® GitHub Actions å®ç° push åè‡ªåŠ¨æ„å»ºï¼ˆé€‚åˆé«˜çº§ç”¨æˆ·ï¼‰\nå¢å¼ºåŠŸèƒ½ï¼š\nè¯„è®ºç³»ç»Ÿï¼šValine &#x2F; Waline &#x2F; Gitalk\nç»Ÿè®¡ï¼šGoogle Analytics &#x2F; ä¸è’œå­\nSEOï¼šsitemap + robots.txt\n\n\næ›´æ–°ç»„ä»¶ï¼šnpm update hexo-cli -g      # æ›´æ–° Hexocd themes/butterfly &amp;&amp; git pull  # æ›´æ–°ä¸»é¢˜\n\n\nğŸ’¡ æœ€åæé†’\nä¸è¦åˆ é™¤ .deploy_git ç›®å½•ï¼ˆéƒ¨ç½²ç¼“å­˜ï¼Œä½†æ— éœ€å¤‡ä»½ï¼‰\næ‰€æœ‰ä¿®æ”¹å‡åœ¨æœ¬åœ°å®Œæˆï¼Œéƒ¨ç½²ä»…æ¨é€ç”Ÿæˆçš„é™æ€æ–‡ä»¶\né‡åˆ°é—®é¢˜ä¼˜å…ˆæŸ¥é˜…ï¼š\nHexo å®˜æ–¹æ–‡æ¡£\nä¸»é¢˜ GitHub Issues\næœç´¢é”™è¯¯å…³é”®è¯ + â€œHexoâ€\n\n\n\nâœ¨ æ­å–œï¼ä½ çš„ä¸“å±æŠ€æœ¯åšå®¢å·²ä¸Šçº¿ï¼åšæŒå†™ä½œï¼Œè®©çŸ¥è¯†æµåŠ¨èµ·æ¥ï½å¦‚æœ‰ç»†èŠ‚ç–‘é—®ï¼Œæ¬¢è¿æä¾›å…·ä½“æŠ¥é”™ä¿¡æ¯è¿›ä¸€æ­¥åˆ†æï¼\n","categories":["ç»éªŒåˆ†äº«"]},{"title":"P4-vSwitchå®éªŒç¯å¢ƒéƒ¨ç½²å’Œå®éªŒæ“ä½œç®€è¦æ‰‹å†Œ","url":"/2026/02/27/p4-vswitch-install/","content":"ç›®å½• {#ç›®å½• .TOC-Heading}1 æ¦‚è¿° 5\n1.1 é¡¹ç›®èƒŒæ™¯ 5\n1.2 ç¯å¢ƒä¿¡æ¯ 5\n2 ç¯å¢ƒéƒ¨ç½² 6\n2.1 ç³»ç»Ÿå®‰è£… 6\n2.2 SwitchèŠ‚ç‚¹ 6\n2.3 GeneratorèŠ‚ç‚¹&#x2F;ReceiverèŠ‚ç‚¹11\n3 l2_switchå®éªŒ 14\n3.1 å®éªŒå‡†å¤‡ 14\n3.2 å®éªŒæ“ä½œ 16\n3.2.1 SwitchèŠ‚ç‚¹ 16\n3.2.2 GeneratorèŠ‚ç‚¹ &amp; ReceiverèŠ‚ç‚¹19\n4 Simple_routerå®éªŒ 23\n4.1 å®éªŒå‡†å¤‡ 23\n4.2 å®éªŒæ“ä½œ 27\n4.2.1 SwitchèŠ‚ç‚¹ 27\n4.2.2 GeneratorèŠ‚ç‚¹ &amp; ReceiverèŠ‚ç‚¹29\nè¡¨1. æ–‡æ¡£ä¿®æ”¹è®°å½• 1\nè¡¨2. æœåŠ¡å™¨ä¿¡æ¯è¡¨ 5\nå›¾1. ç½‘ç»œæ‹“æ‰‘è¿æ¥å›¾ 6\nå›¾2. dpdkç«¯å£ç»‘å®šæƒ…å†µ 9\nå›¾3. å¤§é¡µå†…å­˜æƒ…å†µ 10\nå›¾4. dpdkç«¯å£ç»‘å®šæƒ…å†µ 13\nå›¾5. å¤§é¡µå†…å­˜æƒ…å†µ 13\nå›¾6. l2_switchå®éªŒæ–‡ä»¶ 14\nå›¾7. ovsç½‘æ¡¥æƒ…å†µ 18\nå›¾8. l2_switchå®éªŒæµè¡¨ 19\nå›¾9. å‘åŒ…è½¯ä»¶å¯åŠ¨ 22\nå›¾10. æµè¡¨å˜åŒ– 23\nå›¾11. simple_routerå®éªŒæ–‡ä»¶24\nå›¾12. ovsç½‘æ¡¥æƒ…å†µ 28\nå›¾13. simple_routerå®éªŒæµè¡¨29\nå›¾14. æµè¡¨å˜åŒ– 30\næ¦‚è¿°é¡¹ç›®èƒŒæ™¯å‚è€ƒGithubé¡¹ç›®ã€‚\nhttps://github.com/P4-vSwitch\n{#section .å›¾å}ç¯å¢ƒä¿¡æ¯é¡¹ç›®éƒ¨ç½²ç¯å¢ƒä¸ºè™šæ‹Ÿæœºï¼Œéœ€å°†å…¶ä¸­çš„è„šæœ¬å’Œä»£ç è¿ç§»è‡³ç‰©ç†æœºè¿è¡Œã€‚\nå®éªŒç¯å¢ƒå…±3å°æœåŠ¡å™¨ï¼ŒåŸºæœ¬ä¿¡æ¯å¦‚ä¸‹ï¼Œå®éªŒå®¤ç½‘ç»œå¯ç™»å½•ã€‚\n\n[]{#_Toc17707 .anchor}æœåŠ¡å™¨ä¿¡æ¯è¡¨\n\n+:â€”â€”â€”-:+:â€”â€”â€”â€”â€“:+:â€”â€”â€”â€“:+:â€”â€”â€”â€“:+:â€”â€”â€”â€”â€”-:+| æœåŠ¡å™¨åç§° | IPåœ°å€         | ç”¨æˆ·å      | å¯†ç         | å¤‡æ³¨             |+â€”â€”â€”â€”+â€”â€”â€”â€”â€”-+â€”â€”â€”â€”-+â€”â€”â€”â€”-+â€”â€”â€”â€”â€”â€”+| p4switch   | 192.168.61.133 | root&#x2F;ubuntu | abcd@1234   | system           ||            |                |             |             |                  ||            |                |             |             | Ubuntu 14.04.4   ||            |                |             |             |                  ||            |                |             |             | kernel           ||            |                |             |             |                  ||            |                |             |             | 4.2.0-27-generic |+â€”â€”â€”â€”+â€”â€”â€”â€”â€”-+             |             |                  || p4recv     | 192.168.61.135 |             |             |                  |+â€”â€”â€”â€”+â€”â€”â€”â€”â€”-+             |             |                  || p4gen      | 192.168.61.134 |             |             |                  |+â€”â€”â€”â€”+â€”â€”â€”â€”â€”-+â€”â€”â€”â€”-+â€”â€”â€”â€”-+â€”â€”â€”â€”â€”â€”+\næ‹“æ‰‘è¿æ¥å›¾å¦‚ä¸‹ã€‚\n{width&#x3D;â€5.758333333333334inâ€height&#x3D;â€3.122916666666667inâ€}\nç½‘ç»œæ‹“æ‰‘è¿æ¥å›¾ {#ç½‘ç»œæ‹“æ‰‘è¿æ¥å›¾ .å›¾å}ç¯å¢ƒéƒ¨ç½²ç³»ç»Ÿå®‰è£…Ubuntu 14.04.4ï¼Œå†…æ ¸ç‰ˆæœ¬4.2.0-27-genericã€‚\nSwitchèŠ‚ç‚¹ä½¿ç”¨rootç”¨æˆ·ç™»å½•SwitchèŠ‚ç‚¹ï¼Œæ›´æ–°aptæºï¼Œä¸‹è½½å¿…è¦çš„è½¯ä»¶ä¾èµ–,å»ºè®®å°†è‡ªå¸¦æºæ›¿æ¢ä¸ºå›½å†…æºã€‚\napt-get update\n#apt-get upgrade\napt-get -y install git python-pip fuse libfuse-dev dh-autoreconf openssllibssl-dev cmake libpcap-dev python-yaml\nå®‰è£…plyï¼Œä¸”è¦æ±‚ç‰ˆæœ¬&lt;3.10ï¼Œå»ºè®®ä½¿ç”¨å›½å†…pipæºã€‚\npip install -i https://pypi.tuna.tsinghua.edu.cn/simple ply&#x3D;&#x3D;3.9\nåˆ›å»ºå·¥ä½œç›®å½•ï¼Œå¹¶ä¸‹è½½é¡¹ç›®ä»£ç ã€‚\ncd &#x2F;home\ngit clone https://github.com/P4-vSwitch/vagrant.git\nä¸‹è½½å®‰è£…p4-hliræ¨¡å—\ncd &#x2F;home&#x2F;vagrant\ngit clone https://github.com/p4lang/p4-hlir.git\ncd p4-hlir&#x2F;\npython setup.py install\nä¸‹è½½å®‰è£…p4c-behavioralæ¨¡å—\ncd &#x2F;home&#x2F;vagrant\ngit clone https://github.com/P4-vSwitch/p4c-behavioral.git\ncd p4c-behavioral&#x2F;\ngit checkout ovs\npython setup.py install\nä¸‹è½½OVSæ¨¡å—\ncd &#x2F;home&#x2F;vagrant\ngit clone https://github.com/P4-vSwitch/ovs.git\ncd ovs&#x2F;\ngit checkout p4\ngit submodule update --init\nBuild DPDKæ¨¡å—\ncd &#x2F;home&#x2F;vagrant&#x2F;ovs&#x2F;deps&#x2F;dpdk\npatch -p1 -N &lt; ..&#x2F;..&#x2F;setup-scripts&#x2F;patches&#x2F;dpdk.patch\nmake -j 2 install T&#x3D;x86_64-native-linuxapp-gcc\nå¯¼å…¥ç¯å¢ƒå˜é‡ï¼Œå»ºè®®å¡«å…¥~&#x2F;.bashrcï¼Œé¿å…æ¯æ¬¡æ–°å¼€çª—å£éƒ½éœ€è¦æ‰‹åŠ¨å¯¼å…¥ã€‚\nexport RTE_SDK&#x3D;&#x2F;home&#x2F;vagrant&#x2F;ovs&#x2F;deps&#x2F;dpdk\nexport RTE_TARGET&#x3D;x86_64-native-linuxapp-gcc\nexport DPDK_DIR&#x3D;$RTE_SDK\nexport DPDK_BUILD&#x3D;$DPDK_DIR&#x2F;$RTE_TARGET&#x2F;\né…ç½®DPDKå†…æ ¸æ¨¡å—\ncd &#x2F;home&#x2F;vagrant\nmodprobe uio\ninsmod $RTE_SDK&#x2F;$RTE_TARGET&#x2F;kmod&#x2F;igb_uio.ko\ninsmod $RTE_SDK&#x2F;$RTE_TARGET&#x2F;kmod&#x2F;rte_kni.ko &quot;lo_mode&#x3D;lo_mode_ring&quot;\nå°†æœåŠ¡å™¨ç«¯å£ç»‘å®šè‡³DPDK\nifconfig eth0 down\n$RTE_SDK&#x2F;tools&#x2F;dpdk_nic_bind.py -b igb_uio eth0\nifconfig eth1 down\n$RTE_SDK&#x2F;tools&#x2F;dpdk_nic_bind.py -b igb_uio eth1\næŸ¥çœ‹ç»‘å®šæƒ…å†µ\n$RTE_SDK&#x2F;tools&#x2F;dpdk_nic_bind.py --status\n{width&#x3D;â€5.758333333333334inâ€height&#x3D;â€1.7638888888888888inâ€}\ndpdkç«¯å£ç»‘å®šæƒ…å†µ {#dpdkç«¯å£ç»‘å®šæƒ…å†µ .å›¾å}é…ç½®å¤§é¡µå†…å­˜\ncd &#x2F;home&#x2F;vagrant\nmkdir -p &#x2F;mnt&#x2F;huge\n(mount | grep hugetlbfs) &gt; &#x2F;dev&#x2F;null || sudo mount -t hugetlbfsnodev &#x2F;mnt&#x2F;huge\necho 1024 &gt;&#x2F;sys&#x2F;devices&#x2F;system&#x2F;node&#x2F;node0&#x2F;hugepages&#x2F;hugepages-2048kB&#x2F;nr_hugepages\næŸ¥çœ‹å¤§é¡µå†…å­˜\ngrep -i huge &#x2F;proc&#x2F;meminfo\n{width&#x3D;â€5.763888888888889inâ€height&#x3D;â€1.1131944444444444inâ€}\nå¤§é¡µå†…å­˜æƒ…å†µ {#å¤§é¡µå†…å­˜æƒ…å†µ .å›¾å}Build OVS\ncd &#x2F;home&#x2F;vagrant&#x2F;ovs&#x2F;\n.&#x2F;boot.sh\n.&#x2F;configure --with-dpdk&#x3D;$DPDK_BUILD CFLAGS&#x3D;&quot;-g -O2 -Wno-cast-align&quot;\\\np4inputfile&#x3D;.&#x2F;include&#x2F;p4&#x2F;examples&#x2F;l2_switch&#x2F;l2_switch.p4 \\\np4outputdir&#x3D;.&#x2F;include&#x2F;p4&#x2F;src\nmake -j 2\nåˆ›å»ºOVSæ•°æ®åº“æ–‡ä»¶å’Œæ–‡ä»¶è·¯å¾„\nmkdir -p &#x2F;usr&#x2F;local&#x2F;etc&#x2F;openvswitch\nmkdir -p &#x2F;usr&#x2F;local&#x2F;var&#x2F;run&#x2F;openvswitch\ncd &#x2F;home&#x2F;vagrant&#x2F;ovs&#x2F;ovsdb&#x2F;\n.&#x2F;ovsdb-tool create &#x2F;usr&#x2F;local&#x2F;etc&#x2F;openvswitch&#x2F;conf.db..&#x2F;vswitchd&#x2F;vswitch.ovsschema\nGeneratorèŠ‚ç‚¹&#x2F;ReceiverèŠ‚ç‚¹ä¸¤èŠ‚ç‚¹å®‰è£…æ­¥éª¤ä¸€è‡´ï¼Œåˆå¹¶æè¿°ã€‚\nä½¿ç”¨rootç”¨æˆ·ç™»å½•Generatoræˆ–ReceiverèŠ‚ç‚¹ï¼Œæ›´æ–°aptæºï¼Œä¸‹è½½å¿…è¦çš„è½¯ä»¶ä¾èµ–,å»ºè®®å°†è‡ªå¸¦æºæ›¿æ¢ä¸ºå›½å†…æºã€‚\napt-get update\napt-get upgrade\napt-get -y install git python-pip fuse libfuse-dev dh-autoreconf openssllibssl-dev cmake libpcap-dev python-yaml\nåˆ›å»ºå·¥ä½œç›®å½•ï¼Œå¹¶ä¸‹è½½é¡¹ç›®ä»£ç ã€‚\ncd &#x2F;home\ngit clone https://github.com/P4-vSwitch/vagrant.git\nä¸‹è½½Pktgené¡¹ç›®ä»£ç \ncd &#x2F;home&#x2F;vagrant\ngit clone https://github.com/P4-vSwitch/pktgen.git\ncd pktgen&#x2F;\ngit submodule update --init\nBuild DPDKæ¨¡å—\ncd &#x2F;home&#x2F;vagrant&#x2F;pktgen&#x2F;deps&#x2F;dpdk\nmake -j 2 install T&#x3D;x86_64-native-linuxapp-gcc\nå¯¼å…¥ç¯å¢ƒå˜é‡ï¼Œå»ºè®®å¡«å…¥~&#x2F;.bashrcï¼Œé¿å…æ¯æ¬¡æ–°å¼€çª—å£éƒ½éœ€è¦æ‰‹åŠ¨å¯¼å…¥ã€‚\nexport RTE_SDK&#x3D;&#x2F;home&#x2F;vagrant&#x2F;pktgen&#x2F;deps&#x2F;dpdk\nexport RTE_TARGET&#x3D;x86_64-native-linuxapp-gcc\nexport DPDK_DIR&#x3D;$RTE_SDK\nexport DPDK_BUILD&#x3D;$DPDK_DIR&#x2F;$RTE_TARGET&#x2F;\né…ç½®DPDKå†…æ ¸æ¨¡å—\ncd &#x2F;home&#x2F;vagrant\nmodprobe uio\ninsmod $RTE_SDK&#x2F;$RTE_TARGET&#x2F;kmod&#x2F;igb_uio.ko\ninsmod $RTE_SDK&#x2F;$RTE_TARGET&#x2F;kmod&#x2F;rte_kni.ko &quot;lo_mode&#x3D;lo_mode_ring&quot;\nå°†æœåŠ¡å™¨ç«¯å£ç»‘å®šè‡³DPDK\nifconfig eth0 down\n$RTE_SDK&#x2F;tools&#x2F;dpdk_nic_bind.py -b igb_uio eth0\nifconfig eth1 down\n$RTE_SDK&#x2F;tools&#x2F;dpdk_nic_bind.py -b igb_uio eth1\næŸ¥çœ‹ç»‘å®šæƒ…å†µ\n$RTE_SDK&#x2F;tools&#x2F;dpdk_nic_bind.py --status\n{width&#x3D;â€5.763888888888889inâ€height&#x3D;â€1.7833333333333334inâ€}\ndpdkç«¯å£ç»‘å®šæƒ…å†µ {#dpdkç«¯å£ç»‘å®šæƒ…å†µ-1 .å›¾å}é…ç½®å¤§é¡µå†…å­˜\ncd &#x2F;home&#x2F;vagrant\nmkdir -p &#x2F;mnt&#x2F;huge\n(mount | grep hugetlbfs) &gt; &#x2F;dev&#x2F;null || sudo mount -t hugetlbfsnodev &#x2F;mnt&#x2F;huge\necho 512 &gt;&#x2F;sys&#x2F;devices&#x2F;system&#x2F;node&#x2F;node0&#x2F;hugepages&#x2F;hugepages-2048kB&#x2F;nr_hugepages\næŸ¥çœ‹å¤§é¡µå†…å­˜\ngrep -i huge &#x2F;proc&#x2F;meminfo\n{width&#x3D;â€5.764583333333333inâ€height&#x3D;â€1.332638888888889inâ€}\nå¤§é¡µå†…å­˜æƒ…å†µ {#å¤§é¡µå†…å­˜æƒ…å†µ-1 .å›¾å}Build Pktgenæ¨¡å—\ncd &#x2F;home&#x2F;vagrant&#x2F;pktgen\nmake\nl2_switchå®éªŒå®éªŒå‡†å¤‡å®éªŒè„šæœ¬æ–‡ä»¶å’Œé…ç½®æ–‡ä»¶ä¸­çš„å‚æ•°éœ€æ ¹æ®æœåŠ¡å™¨ç½‘å£å®é™…æƒ…å†µè¿›è¡Œä¿®æ”¹ï¼Œå®éªŒè·¯å¾„å¦‚ä¸‹å›¾æ‰€ç¤ºã€‚ä¸åŒèŠ‚ç‚¹éœ€è¦ä¿®æ”¹çš„ä½ç½®ä¸åŒï¼Œä»¥ä¸‹åˆ†åˆ«æè¿°ã€‚\n{width&#x3D;â€5.761805555555555inâ€height&#x3D;â€1.2694444444444444inâ€}\nl2_switchå®éªŒæ–‡ä»¶ {#l2_switchå®éªŒæ–‡ä»¶ .å›¾å}SwitchèŠ‚ç‚¹ï¼š\nl2_switch.p4&#x2F;generator.pkt&#x2F;receiver.pktï¼šä¿æŒä¸å˜\nl2_switch.shï¼šå°†æµè¡¨ä¸­çš„macåœ°å€ï¼Œæ›´æ¢ä¸ºGeneratorå’ŒReceiveræœåŠ¡å™¨åˆ†åˆ«è¿æ¥Switchçš„ç½‘å£çš„macåœ°å€ï¼Œå¦‚ä¸‹æ ‡çº¢ä½ç½®æ‰€ç¤ºã€‚\n#! &#x2F;bin&#x2F;sh -ve\n# Please make sure that you update the path to the current OVSdirectory.\nDIR&#x3D;&#x2F;home&#x2F;vagrant&#x2F;ovs&#x2F;utilities\n$DIR&#x2F;ovs-ofctl --protocols&#x3D;OpenFlow15 del-flows br0\n# SMAC Table 0\n$DIR&#x2F;ovs-ofctl --protocols&#x3D;OpenFlow15 add-flow br0&quot;table&#x3D;0,priority&#x3D;32768,ethernet__srcAddr&#x3D;0x74a4b500eee4actions&#x3D;resubmit(,1)&quot;\n$DIR&#x2F;ovs-ofctl --protocols&#x3D;OpenFlow15 add-flow br0&quot;table&#x3D;0,priority&#x3D;32768,ethernet__srcAddr&#x3D;0x74a4b500ef02actions&#x3D;resubmit(,1)&quot;\n$DIR&#x2F;ovs-ofctl --protocols&#x3D;OpenFlow15 add-flow br0&quot;table&#x3D;0,priority&#x3D;0 actions&#x3D;controller&quot;\n# DMAC Table 1\n$DIR&#x2F;ovs-ofctl --protocols&#x3D;OpenFlow15 add-flow br0&quot;table&#x3D;1,priority&#x3D;32768,ethernet__dstAddr&#x3D;0x74a4b500eee4actions&#x3D;set_field:1-&gt;reg0,resubmit(,2)&quot;\n$DIR&#x2F;ovs-ofctl --protocols&#x3D;OpenFlow15 add-flow br0&quot;table&#x3D;1,priority&#x3D;32768,ethernet__dstAddr&#x3D;0x74a4b500ef02actions&#x3D;set_field:2-&gt;reg0,resubmit(,2)&quot;\n$DIR&#x2F;ovs-ofctl --protocols&#x3D;OpenFlow15 add-flow br0&quot;table&#x3D;1,priority&#x3D;0 actions&#x3D;flood&quot;\n# SRC Pruning Table 2\n$DIR&#x2F;ovs-ofctl --protocols&#x3D;OpenFlow15 add-flow br0&quot;table&#x3D;2,priority&#x3D;32768,in_port&#x3D;1,reg0&#x3D;1 actions&#x3D;&quot;\n$DIR&#x2F;ovs-ofctl --protocols&#x3D;OpenFlow15 add-flow br0&quot;table&#x3D;2,priority&#x3D;32768,in_port&#x3D;2,reg0&#x3D;2 actions&#x3D;&quot;\n$DIR&#x2F;ovs-ofctl --protocols&#x3D;OpenFlow15 add-flow br0&quot;table&#x3D;2,priority&#x3D;32768,in_port&#x3D;3,reg0&#x3D;3 actions&#x3D;&quot;\n$DIR&#x2F;ovs-ofctl --protocols&#x3D;OpenFlow15 add-flow br0&quot;table&#x3D;2,priority&#x3D;32768,in_port&#x3D;4,reg0&#x3D;4 actions&#x3D;&quot;\n$DIR&#x2F;ovs-ofctl --protocols&#x3D;OpenFlow15 add-flow br0&quot;table&#x3D;2,priority&#x3D;32768,in_port&#x3D;5,reg0&#x3D;5 actions&#x3D;&quot;\n$DIR&#x2F;ovs-ofctl --protocols&#x3D;OpenFlow15 add-flow br0&quot;table&#x3D;2,priority&#x3D;32768,in_port&#x3D;6,reg0&#x3D;6 actions&#x3D;&quot;\n$DIR&#x2F;ovs-ofctl --protocols&#x3D;OpenFlow15 add-flow br0&quot;table&#x3D;2,priority&#x3D;0 actions&#x3D;deparse,output:NXM_NX_REG0[]&quot;\ngeneratorèŠ‚ç‚¹ï¼š\nåªä¿®æ”¹generator.pktæ–‡ä»¶ï¼Œå°†generatorä¸switchè¿æ¥çš„ç½‘å£macåœ°å€å¡«å…¥ï¼Œå¦‚ä¸‹æ‰€ç¤ºã€‚\nset mac 0 74:a4:b5:00:ee:e4\nreceiverèŠ‚ç‚¹ï¼š\nåªä¿®æ”¹receiver.pktæ–‡ä»¶ï¼Œå°†receiverä¸switchè¿æ¥çš„ç½‘å£macåœ°å€å¡«å…¥ï¼Œå¦‚ä¸‹æ‰€ç¤ºã€‚\nset mac 0 74:a4:b5:00:ef:02\nå®éªŒæ“ä½œSwitchèŠ‚ç‚¹ä½¿ç”¨rootç”¨æˆ·ï¼Œç™»å½•switchèŠ‚ç‚¹ã€‚\nç¼–è¯‘l2_switch.p4cd &#x2F;home&#x2F;vagrant&#x2F;ovs\n.&#x2F;configure --with-dpdk&#x3D;$DPDK_BUILD CFLAGS&#x3D;&quot;-g -O2 -Wno-cast-align&quot;p4inputfile&#x3D;&#x2F;home&#x2F;vagrant&#x2F;examples&#x2F;l2_switch&#x2F;l2_switch.p4p4outputdir&#x3D;.&#x2F;include&#x2F;p4&#x2F;src\nmake clean\nmake -j 2\nå¯åŠ¨ovsdb-server(ä¿æŒåå°è¿è¡Œ)cd &#x2F;home&#x2F;vagrant&#x2F;ovs&#x2F;ovsdb\nnohup .&#x2F;ovsdb-server--remote&#x3D;punix:&#x2F;usr&#x2F;local&#x2F;var&#x2F;run&#x2F;openvswitch&#x2F;db.sock \\\n--remote&#x3D;db:Open_vSwitch,Open_vSwitch,manager_options --pidfile &amp;\nå¯åŠ¨ovs-vswitchd(ä¿æŒåå°è¿è¡Œ)cd &#x2F;home&#x2F;vagrant&#x2F;ovs&#x2F;vswitchd\nnohup .&#x2F;ovs-vswitchd --dpdk -c 0x1 -n 4 --unix:&#x2F;usr&#x2F;local&#x2F;var&#x2F;run&#x2F;openvswitch&#x2F;db.sock --pidfile &amp;\nåˆ›å»ºOVSç½‘æ¡¥cd &#x2F;home&#x2F;vagrant&#x2F;ovs&#x2F;utilities\n.&#x2F;ovs-vsctl --no-wait init\n.&#x2F;ovs-vsctl add-br br0 -- set bridge br0 datapath_type&#x3D;netdev\n.&#x2F;ovs-vsctl set bridge br0 protocols&#x3D;OpenFlow15\n.&#x2F;ovs-vsctl add-port br0 dpdk0 -- set Interface dpdk0 type&#x3D;dpdk\n.&#x2F;ovs-vsctl add-port br0 dpdk1 -- set Interface dpdk1 type&#x3D;dpdk\nå¦‚æœéœ€è¦åˆ é™¤ï¼Œåˆ™æ‰§è¡Œ.&#x2F;ovs-vsctl del-br br0\næŸ¥çœ‹ç½‘æ¡¥æ‰§è¡Œ.&#x2F;ovs-vsctl show\n{width&#x3D;â€5.7659722222222225inâ€height&#x3D;â€2.2305555555555556inâ€}\novsç½‘æ¡¥æƒ…å†µ {#ovsç½‘æ¡¥æƒ…å†µ .å›¾å}åŠ è½½æµè¡¨cd &#x2F;home&#x2F;vagrant&#x2F;examples&#x2F;l2_switch&#x2F;\n.&#x2F;l2_switch.sh\nåŠ è½½å®Œæˆåï¼Œå¯æ‰§è¡Œå¦‚ä¸‹å‘½ä»¤æŸ¥çœ‹ã€‚\ncd &#x2F;home&#x2F;vagrant&#x2F;ovs&#x2F;utilities\n.&#x2F;ovs-ofctl --protocols&#x3D;OpenFlow15 dump-flows br0\n{width&#x3D;â€5.752777777777778inâ€height&#x3D;â€1.0763888888888888inâ€}\nl2_switchå®éªŒæµè¡¨ {#l2_switchå®éªŒæµè¡¨ .å›¾å}GeneratorèŠ‚ç‚¹ &amp; ReceiverèŠ‚ç‚¹ä½¿ç”¨rootç”¨æˆ·ï¼Œåˆ†åˆ«ä»ä¸åŒç»ˆç«¯çª—å£ç™»å½•generatorèŠ‚ç‚¹å’ŒreceiverèŠ‚ç‚¹ã€‚\nå¯åŠ¨å‘åŒ…ç¨‹åºGeneratorèŠ‚ç‚¹ï¼š\ncd &#x2F;home&#x2F;vagrant&#x2F;pktgen\n.&#x2F;app&#x2F;app&#x2F;x86_64-native-linuxapp-gcc&#x2F;app&#x2F;pktgen -c 0x3 -n 4 -- -P -m&quot;1.0&quot; -f &#x2F;home&#x2F;vagrant&#x2F;examples&#x2F;l2_switch&#x2F;generator.pkt\nReceiverèŠ‚ç‚¹ï¼š\ncd &#x2F;home&#x2F;vagrant&#x2F;pktgen\n.&#x2F;app&#x2F;app&#x2F;x86_64-native-linuxapp-gcc&#x2F;app&#x2F;pktgen -c 0x3 -n 4 -- -P -m&quot;1.0&quot; -f &#x2F;home&#x2F;vagrant&#x2F;examples&#x2F;l2_switch&#x2F;receiver.pkt\nå¯åŠ¨åå‡ºç°å¦‚ä¸‹å›¾æ‰€ç¤ºå›æ˜¾ã€‚\n{width&#x3D;â€5.759722222222222inâ€height&#x3D;â€5.345833333333333inâ€}\n{width&#x3D;â€5.7625inâ€height&#x3D;â€4.083333333333333inâ€}\n{width&#x3D;â€5.759722222222222inâ€height&#x3D;â€3.6256944444444446inâ€}\n{width&#x3D;â€5.7659722222222225inâ€height&#x3D;â€3.7909722222222224inâ€}\n{width&#x3D;â€5.7625inâ€height&#x3D;â€3.9631944444444445inâ€}\nå‘åŒ…è½¯ä»¶å¯åŠ¨ {#å‘åŒ…è½¯ä»¶å¯åŠ¨ .å›¾å}å¼€å§‹å‘åŒ…å›åˆ°generatorèŠ‚ç‚¹çš„ç•Œé¢ï¼Œè¾“å…¥å¹¶æ‰§è¡Œstart 0ï¼Œå¼€å§‹å‘åŒ…ã€‚\næ­¤æ—¶ï¼Œåœ¨switchèŠ‚ç‚¹å¯æŸ¥çœ‹æµè¡¨ï¼Œè‹¥æ•°æ®åŒ…æ•°é‡éšæ—¶é—´å‡ºç°å¢é•¿ï¼Œåˆ™è¯´æ˜å‘æŠ¥æˆåŠŸï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºã€‚\n{width&#x3D;â€5.763888888888889inâ€height&#x3D;â€1.1402777777777777inâ€}\n{width&#x3D;â€5.764583333333333inâ€height&#x3D;â€1.1694444444444445inâ€}\næµè¡¨å˜åŒ– {#æµè¡¨å˜åŒ– .å›¾å}å®éªŒç»“æŸåï¼Œå›åˆ°genaratorèŠ‚ç‚¹ï¼Œè¾“å…¥å¹¶æ‰§è¡Œstop 0ï¼Œåœæ­¢å‘åŒ…ã€‚\nSimple_routerå®éªŒå®éªŒå‡†å¤‡è‹¥æ¥ç€ä¸Šè¿°l2_switchå®éªŒç»§ç»­ï¼Œåˆ™éœ€è¦å…ˆå°†ç¯å¢ƒæ¸…ç†ã€‚\nåœæ­¢generatorèŠ‚ç‚¹å’ŒreceiverèŠ‚ç‚¹çš„å‘åŒ…ç¨‹åºï¼Œå¹¶é€€å‡ºã€‚\nstop 0\nquit\nåˆ é™¤switchèŠ‚ç‚¹çš„ovsdbå’Œovsä¸»è¿›ç¨‹ã€‚\nps -ef | grep ovs\nkill -9 xxxxx\nkill -9 xxxxx\nå®éªŒè„šæœ¬æ–‡ä»¶å’Œé…ç½®æ–‡ä»¶ä¸­çš„å‚æ•°éœ€æ ¹æ®æœåŠ¡å™¨ç½‘å£å®é™…æƒ…å†µè¿›è¡Œä¿®æ”¹ï¼Œå®éªŒè·¯å¾„å¦‚ä¸‹å›¾æ‰€ç¤ºã€‚ä¸åŒèŠ‚ç‚¹éœ€è¦ä¿®æ”¹çš„ä½ç½®ä¸åŒï¼Œä»¥ä¸‹åˆ†åˆ«æè¿°ã€‚\n{width&#x3D;â€5.759722222222222inâ€height&#x3D;â€0.8493055555555555inâ€}\nsimple_routerå®éªŒæ–‡ä»¶ {#simple_routerå®éªŒæ–‡ä»¶ .å›¾å}SwitchèŠ‚ç‚¹ï¼š\nsimple_router.p4&#x2F;generator.pkt&#x2F;receiver.pktï¼šä¿æŒä¸å˜\nsimple_router.shï¼šå°†æµè¡¨ä¸­çš„macåœ°å€ï¼Œæ›´æ¢ä¸ºGeneratorå’ŒReceiveræœåŠ¡å™¨åˆ†åˆ«è¿æ¥Switchçš„ç½‘å£çš„macåœ°å€ï¼Œå¦‚ä¸‹æ ‡çº¢ä½ç½®æ‰€ç¤ºã€‚\n#! &#x2F;bin&#x2F;sh -ve\n# Please make sure that you update the path to the current OVSdirectory.\nDIR&#x3D;&#x2F;home&#x2F;vagrant&#x2F;ovs&#x2F;utilities\n# For this test we will pre-populate ARP caches at the end-hosts\n$DIR&#x2F;ovs-ofctl --protocols&#x3D;OpenFlow15 del-flows br0\n# Verify Checksum (Table 0)\n$DIR&#x2F;ovs-ofctl --protocols&#x3D;OpenFlow15 add-flow br0&quot;table&#x3D;0,priority&#x3D;32768,ethernet__etherType&#x3D;0x800 \\\nactions&#x3D;calc_fields_verify(ipv4__hdrChecksum,csum16,fields:ipv4__version_ihl,ipv4__diffserv,ipv4__totalLen,ipv4__identification,ipv4__flags_fragOffset,ipv4__ttl,ipv4__protocol,ipv4__srcAddr,ipv4__dstAddr),\\\nresubmit(,1)&quot;\n$DIR&#x2F;ovs-ofctl --protocols&#x3D;OpenFlow15 add-flow br0&quot;table&#x3D;0,priority&#x3D;0 actions&#x3D;&quot;\n# IPv4 LPM (Table 1)\n$DIR&#x2F;ovs-ofctl --protocols&#x3D;OpenFlow15 add-flow br0&quot;table&#x3D;1,priority&#x3D;32768,ipv4__dstAddr&#x3D;0x0A00000F&#x2F;0xFFFFFF00 \\\nactions&#x3D;set_field:0x0B00000F-&gt;routing_metadata_nhop_ipv4, \\\nset_field:2-&gt;reg0, \\\nset_field:63-&gt;ipv4__ttl, \\\nresubmit(,2)&quot;\n$DIR&#x2F;ovs-ofctl --protocols&#x3D;OpenFlow15 add-flow br0&quot;table&#x3D;1,priority&#x3D;0 actions&#x3D;&quot;\n# Forward (Table 2)\n$DIR&#x2F;ovs-ofctl --protocols&#x3D;OpenFlow15 add-flow br0&quot;table&#x3D;2,priority&#x3D;32768,routing_metadata_nhop_ipv4&#x3D;0x0B00000F \\\nactions&#x3D;set_field:0x74a4b500eee4-&gt;ethernet__dstAddr, \\\nresubmit(,3)&quot;\n$DIR&#x2F;ovs-ofctl --protocols&#x3D;OpenFlow15 add-flow br0&quot;table&#x3D;2,priority&#x3D;0 actions&#x3D;&quot;\n# Send Frame (Table 3)\n$DIR&#x2F;ovs-ofctl --protocols&#x3D;OpenFlow15 add-flow br0&quot;table&#x3D;3,priority&#x3D;32768,reg0&#x3D;2 \\\nactions&#x3D;set_field:0x74a4b500ef02-&gt;ethernet__srcAddr, \\\ncalc_fields_update(ipv4__hdrChecksum,csum16,fields:ipv4__version_ihl,ipv4__diffserv,ipv4__totalLen,ipv4__identification,ipv4__flags_fragOffset,ipv4__ttl,ipv4__protocol,ipv4__srcAddr,ipv4__dstAddr),\\\ndeparse, \\\noutput:NXM_NX_REG0[]&quot;\n$DIR&#x2F;ovs-ofctl --protocols&#x3D;OpenFlow15 add-flow br0&quot;table&#x3D;3,priority&#x3D;0 actions&#x3D;&quot;\ngeneratorèŠ‚ç‚¹ï¼š\nåªä¿®æ”¹generator.pktæ–‡ä»¶ï¼Œå°†generatorä¸switchè¿æ¥çš„ç½‘å£macåœ°å€å¡«å…¥ï¼Œå¦‚ä¸‹æ‰€ç¤ºã€‚\nset mac 0 74:a4:b5:00:ee:e4\nset ip src 0 10.0.0.14&#x2F;24\nset ip dst 0 10.0.0.15\nreceiverèŠ‚ç‚¹ï¼š\nåªä¿®æ”¹receiver.pktæ–‡ä»¶ï¼Œå°†receiverä¸switchè¿æ¥çš„ç½‘å£macåœ°å€å¡«å…¥ï¼Œå¦‚ä¸‹æ‰€ç¤ºã€‚\nset mac 0 74:a4:b5:00:ef:02\nset ip src 0 10.0.0.15&#x2F;24\nset ip dst 0 10.0.0.14\nå®éªŒæ“ä½œSwitchèŠ‚ç‚¹ä½¿ç”¨rootç”¨æˆ·ï¼Œç™»å½•switchèŠ‚ç‚¹ã€‚\nç¼–è¯‘simple_router.p4cd &#x2F;home&#x2F;vagrant&#x2F;ovs\n.&#x2F;configure --with-dpdk&#x3D;$DPDK_BUILD CFLAGS&#x3D;&quot;-g -O2 -Wno-cast-align&quot;p4inputfile&#x3D;&#x2F;home&#x2F;vagrant&#x2F;examples&#x2F;simple_router&#x2F;simple_router.p4p4outputdir&#x3D;.&#x2F;include&#x2F;p4&#x2F;src\nmake clean\nmake -j 2\nå¯åŠ¨ovsdb-server(ä¿æŒåå°è¿è¡Œ)cd &#x2F;home&#x2F;vagrant&#x2F;ovs&#x2F;ovsdb\nnohup .&#x2F;ovsdb-server--remote&#x3D;punix:&#x2F;usr&#x2F;local&#x2F;var&#x2F;run&#x2F;openvswitch&#x2F;db.sock \\\n--remote&#x3D;db:Open_vSwitch,Open_vSwitch,manager_options --pidfile &amp;\nå¯åŠ¨ovs-vswitchd(ä¿æŒåå°è¿è¡Œ)cd &#x2F;home&#x2F;vagrant&#x2F;ovs&#x2F;vswitchd\nnohup .&#x2F;ovs-vswitchd --dpdk -c 0x1 -n 4 --unix:&#x2F;usr&#x2F;local&#x2F;var&#x2F;run&#x2F;openvswitch&#x2F;db.sock --pidfile &amp;\nåˆ›å»ºOVSç½‘æ¡¥cd &#x2F;home&#x2F;vagrant&#x2F;ovs&#x2F;utilities\n.&#x2F;ovs-vsctl --no-wait init\n.&#x2F;ovs-vsctl add-br br0 -- set bridge br0 datapath_type&#x3D;netdev\n.&#x2F;ovs-vsctl set bridge br0 protocols&#x3D;OpenFlow15\n.&#x2F;ovs-vsctl add-port br0 dpdk0 -- set Interface dpdk0 type&#x3D;dpdk\n.&#x2F;ovs-vsctl add-port br0 dpdk1 -- set Interface dpdk1 type&#x3D;dpdk\nå¦‚æœéœ€è¦åˆ é™¤ï¼Œåˆ™æ‰§è¡Œ.&#x2F;ovs-vsctl del-br br0\næŸ¥çœ‹ç½‘æ¡¥æ‰§è¡Œ.&#x2F;ovs-vsctl show\n{width&#x3D;â€5.7659722222222225inâ€height&#x3D;â€2.2305555555555556inâ€}\novsç½‘æ¡¥æƒ…å†µ {#ovsç½‘æ¡¥æƒ…å†µ-1 .å›¾å}åŠ è½½æµè¡¨cd &#x2F;home&#x2F;vagrant&#x2F;examples&#x2F;simple_router&#x2F;\n.&#x2F;simple_router.sh\nåŠ è½½å®Œæˆåï¼Œå¯æ‰§è¡Œå¦‚ä¸‹å‘½ä»¤æŸ¥çœ‹ã€‚\ncd &#x2F;home&#x2F;vagrant&#x2F;ovs&#x2F;utilities\n.&#x2F;ovs-ofctl --protocols&#x3D;OpenFlow15 dump-flows br0\n{width&#x3D;â€5.767361111111111inâ€height&#x3D;â€1.229861111111111inâ€}\nsimple_routerå®éªŒæµè¡¨ {#simple_routerå®éªŒæµè¡¨ .å›¾å}GeneratorèŠ‚ç‚¹ &amp; ReceiverèŠ‚ç‚¹ä½¿ç”¨rootç”¨æˆ·ï¼Œåˆ†åˆ«ä»ä¸åŒç»ˆç«¯çª—å£ç™»å½•generatorèŠ‚ç‚¹å’ŒreceiverèŠ‚ç‚¹ã€‚\nå¯åŠ¨å‘åŒ…ç¨‹åºGeneratorèŠ‚ç‚¹ï¼š\ncd &#x2F;home&#x2F;vagrant&#x2F;pktgen\n.&#x2F;app&#x2F;app&#x2F;x86_64-native-linuxapp-gcc&#x2F;app&#x2F;pktgen -c 0x3 -n 4 -- -P -m&quot;1.0&quot; -f &#x2F;home&#x2F;vagrant&#x2F;examples&#x2F;simple_router&#x2F;generator.pkt\nReceiverèŠ‚ç‚¹ï¼š\ncd &#x2F;home&#x2F;vagrant&#x2F;pktgen\n.&#x2F;app&#x2F;app&#x2F;x86_64-native-linuxapp-gcc&#x2F;app&#x2F;pktgen -c 0x3 -n 4 -- -P -m&quot;1.0&quot; -f &#x2F;home&#x2F;vagrant&#x2F;examples&#x2F;simple_router&#x2F;receiver.pkt\nå¯åŠ¨åå‡ºç°å›æ˜¾ä¸l2_switchå®éªŒä¸€è‡´ã€‚\nå¼€å§‹å‘åŒ…å›åˆ°generatorèŠ‚ç‚¹çš„ç•Œé¢ï¼Œè¾“å…¥å¹¶æ‰§è¡Œstart 0ï¼Œå¼€å§‹å‘åŒ…ã€‚\næ­¤æ—¶ï¼Œåœ¨switchèŠ‚ç‚¹å¯æŸ¥çœ‹æµè¡¨ï¼Œè‹¥æ•°æ®åŒ…æ•°é‡éšæ—¶é—´å‡ºç°å¢é•¿ï¼Œåˆ™è¯´æ˜å‘æŠ¥æˆåŠŸï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºã€‚\n{width&#x3D;â€5.763888888888889inâ€height&#x3D;â€1.1472222222222221inâ€}\n{width&#x3D;â€5.759722222222222inâ€height&#x3D;â€1.1659722222222222inâ€}\næµè¡¨å˜åŒ– {#æµè¡¨å˜åŒ–-1 .å›¾å}å®éªŒç»“æŸåï¼Œå›åˆ°genaratorèŠ‚ç‚¹ï¼Œè¾“å…¥å¹¶æ‰§è¡Œstop 0ï¼Œåœæ­¢å‘åŒ…ã€‚\n","categories":["ç³»ç»Ÿå®‰è£…ä¸è½¯ä»¶éƒ¨ç½²"]}]